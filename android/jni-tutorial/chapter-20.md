# 20장. 중간 요약

지금까지 원시데이터형과 참조형 데이터형인 문자열과 배열을 다루어 보았다. 예제코드를 보면 알 수 있듯이 원시 데이터형은 자바레이어와 네이티브레이어 간에 자유롭게 사용하는 것이 가능했다. 즉, 특정 변환이 필요하지 않았다. 그러나, 참조형은 변환이 필요했다.

자바의 참조형을 읽거나 변경하려면 반드시 자바 참조형을 가리키는 C언어 포인터를 JNIEnv의 특정 함수를 통해 얻어 와야 하고 그 C언어 포인터를 통해서 자바 참조형 데이터를 읽거나 변경할 수 있다.

그와 반대로 C/C++ 데이터를 자바 레이어로 전달 하려면 반드시 C/C++ 데이터를 담을 수 있는 자바의 참조형 데이터가 필요하다. 즉, JNIEnv의 특정 함수를 사용해 C/C++ 데이터를 담을 주머니 같은 자바 참조형 데이터의 인스턴스를 생성한 다음 C/C++ 데이터를 자바 참조형 데이터 인스턴스\(주머니\)에 복사하거나 주머니를 가리키는 포인터를 통해 값을 설정해서 자바 참조형 데이터 인스턴스\(주머니\)를 자바레이어로 넘긴다.

따라서 C/C++의 구조체나 클래스의 인스턴스를 자바 레이어로 전달하려면 자바 레이어에 그와 상응하는 클래스가 반드시 있어야 한다. 상응하는 자바클래스 인스턴스를 생성하고 그 인스턴스에 C/C++ 구조체나 클래스 인스턴스의 값을 설정해서 자바 클래스 인스턴스를 자바 레이어로 넘기는 것이다.

이렇게 하려면 자바 레이어의 클래스를 찾고 그 클래스에서 멤버 함수나 멤버 변수를 찾는 리플렉션 기능이 필요하다. 다음 장부터 이 주제를 다룰 것이다.

